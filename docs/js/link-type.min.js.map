{"version":3,"sources":["link-type.js"],"names":["window","NS","setClass","tar","cls","enabled","val","key","substr","startsWith","dataset","c","join","classList","add","remove","ALLOWED_CLASSES","FILE_EXT_TABLE","doc","docx","xls","xlsx","ppt","pptx","pdf","IMG_EXT_TABLE","jpeg","jpg","png","gif","observing","initializeObservation","opts","sel","includes","push","os","fn","length","mo","MutationObserver","rs","r","n","addedNodes","nodeType","tagName","o","observe","childList","subtree","observeAddition","document","querySelectorAll","addClassByUrl","getAttribute","addClass","a","url","isImageLink","styleLinkImage","ti","imageExtensionTable","getFileExtension","styleLinkToImage","className","childNodes","isEmptyLink","cs","getComputedStyle","display","isSimpleLink","styleLinkSimple","innerHTML","trim","isSimpleUrlLink","split","allowedClasses","ok","outIsUp","p","indexOf","id","substring","t","getElementById","location","href","replace","hash","from","getBoundingClientRect","top","isUrlAnchor","isUrlExternal","styleLinkExternal","styleLinkAnchor","ex","tf","fileExtensionTable","styleLinkFile","protocol","host","match","b0","b1","e0","e1","endsWith","last","pop","i","lastIndexOf","toLowerCase","applyType","as","Object","assign","observedSelector","applyTypeByUrl"],"mappings":"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","file":"link-type.min.js","sourcesContent":["/**\n *\n * Link - Anchor Type\n *\n * @author Takuto Yanagida\n * @version 2021-12-26\n *\n */\n\n\n'use strict';\n\nwindow['NACSS']         = window['NACSS']         || {};\nwindow['NACSS']['link'] = window['NACSS']['link'] || {};\n\n\n((NS) => {\n\n\t/**\n\t *\n\t * Style Class Utilities\n\t *\n\t * @author Takuto Yanagida\n\t * @version 2021-11-11\n\t *\n\t */\n\t\n\t\n\tfunction hasClass(tar, cls) {\n\t\tconst key = cls.substr(1);\n\t\tif (cls.startsWith(':')) {\n\t\t\treturn tar.dataset[key] !== undefined;\n\t\t} else {\n\t\t\treturn tar.classList.contains(key);\n\t\t}\n\t}\n\t\n\tfunction setClass(tar, cls, enabled = true, val = '') {\n\t\tconst key = cls.substr(1);\n\t\tif (cls.startsWith(':')) {\n\t\t\tif (enabled) {\n\t\t\t\ttar.dataset[key] = val;\n\t\t\t} else {\n\t\t\t\tdelete tar.dataset[key];\n\t\t\t}\n\t\t} else {\n\t\t\tconst c = [key, val].join('-');\n\t\t\tif (enabled) {\n\t\t\t\ttar.classList.add(c);\n\t\t\t} else {\n\t\t\t\ttar.classList.remove(c);\n\t\t\t}\n\t\t}\n\t}\n\t\n\tfunction getSelector(cls) {\n\t\tif (cls.startsWith(':')) {\n\t\t\treturn `*[data-${cls.substr(1).replace(/([A-Z])/g, c => '-' + c.charAt(0).toLowerCase())}]`;\n\t\t} else {\n\t\t\treturn `*${cls}`;\n\t\t}\n\t}\n\t\n\n\t/**\n\t *\n\t * Type\n\t *\n\t * @author Takuto Yanagida\n\t * @version 2022-10-05\n\t *\n\t */\n\t\n\t\n\tfunction apply(as, opts = {}) {\n\t\topts = Object.assign({\n\t\t\tstyleLinkImage     : ':ncLinkImage',\n\t\t\tstyleLinkSimple    : ':ncLinkSimple',\n\t\t\tstyleLinkAnchor    : ':ncLinkAnchor',\n\t\t\tstyleLinkExternal  : ':ncLinkExternal',\n\t\t\tstyleLinkFile      : ':ncLinkFile',\n\t\t\tstyleLinkToImage   : ':ncLinkToImage',\n\t\t\tallowedClasses     : ALLOWED_CLASSES,\n\t\t\tfileExtensionTable : FILE_EXT_TABLE,\n\t\t\timageExtensionTable: IMG_EXT_TABLE,\n\t\t\tisUrlExternal      : isUrlExternal,\n\t\t\tobservedSelector   : null,\n\t\t}, opts);\n\t\n\t\tfor (const a of as) {\n\t\t\taddClass(a, a.getAttribute('href'), opts);\n\t\t}\n\t\tinitializeObservation(opts);\n\t}\n\t\n\tfunction applyByUrl(as, opts = {}) {\n\t\topts = Object.assign({\n\t\t\tstyleLinkAnchor    : ':ncLinkAnchor',\n\t\t\tstyleLinkExternal  : ':ncLinkExternal',\n\t\t\tstyleLinkFile      : ':ncLinkFile',\n\t\t\tstyleLinkToImage   : ':ncLinkToImage',\n\t\t\tfileExtensionTable : FILE_EXT_TABLE,\n\t\t\timageExtensionTable: IMG_EXT_TABLE,\n\t\t\tisUrlExternal      : isUrlExternal,\n\t\t\tobservedSelector   : null,\n\t\t}, opts);\n\t\n\t\tfor (const a of as) {\n\t\t\taddClassByUrl(a, a.getAttribute('href'), opts);\n\t\t}\n\t\tinitializeObservation(opts);\n\t}\n\t\n\tconst ALLOWED_CLASSES = [\n\t\t'alignleft',\n\t\t'aligncenter',\n\t\t'alignright',\n\t\t'size-thumbnail',\n\t\t'size-small',\n\t\t'size-medium-small',  // For backward compatibility\n\t\t'size-medium',\n\t\t'size-medium-large',\n\t\t'size-medium_large',\n\t\t'size-large',\n\t\t'size-x-large',\n\t\t'size-xx-large',\n\t\t'size-xxx-large',\n\t\t'size-full'\n\t];\n\t\n\tconst FILE_EXT_TABLE = {\n\t\tdoc : 'doc',\n\t\tdocx: 'doc',\n\t\txls : 'xls',\n\t\txlsx: 'xls',\n\t\tppt : 'ppt',\n\t\tpptx: 'ppt',\n\t\tpdf : 'pdf',\n\t};\n\t\n\tconst IMG_EXT_TABLE = {\n\t\tjpeg: 'jpg',\n\t\tjpg : 'jpg',\n\t\tpng : 'png',\n\t\tgif : 'gif',\n\t};\n\t\n\t\n\t// -------------------------------------------------------------------------\n\t\n\t\n\tconst observing = [];\n\t\n\tfunction initializeObservation(opts) {\n\t\tconst sel = opts['observedSelector'];\n\t\tif (sel && !observing.includes(sel)) {\n\t\t\tobserving.push(sel);\n\t\t\tconst os = document.querySelectorAll(sel);\n\t\t\tobserveAddition(os, o => addClassByUrl(o, o.getAttribute('href'), opts));\n\t\t}\n\t}\n\t\n\tfunction addClass(a, url, opts) {\n\t\tif (isImageLink(a, opts)) {\n\t\t\tsetClass(a, opts.styleLinkImage);\n\t\t\tconst ti = opts.imageExtensionTable[getFileExtension(url)] ?? null;\n\t\t\tif (ti) {\n\t\t\t\tsetClass(a, opts.styleLinkToImage);\n\t\t\t\tsetClass(a, opts.styleLinkToImage, true, ti);\n\t\t\t}\n\t\t} else {\n\t\t\tif (isEmptyLink(a)) {\n\t\t\t\taddClassByUrl(a, url, opts);\n\t\t\t} else if (isSimpleLink(a)) {\n\t\t\t\tsetClass(a, opts.styleLinkSimple);\n\t\t\t\tif (isSimpleUrlLink(a, url)) {\n\t\t\t\t\tsetClass(a, opts.styleLinkSimple, true, 'url');\n\t\t\t\t}\n\t\t\t\taddClassByUrl(a, url, opts);\n\t\t\t}\n\t\t}\n\t}\n\t\n\tfunction isImageLink(a, opts) {\n\t\tif (a.className) {\n\t\t\tfor (const c of a.className.split(' ')) {\n\t\t\t\tif (!opts.allowedClasses.includes(c)) return false;\n\t\t\t}\n\t\t}\n\t\tlet ok = false;\n\t\tfor (const c of a.childNodes) {\n\t\t\tif (c.nodeType === 1) {  // ELEMENT_NODE\n\t\t\t\tif (!ok && c.tagName === 'IMG') {\n\t\t\t\t\tok = true;\n\t\t\t\t} else {\n\t\t\t\t\tok = false;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn ok;\n\t}\n\t\n\tfunction isSimpleLink(a) {\n\t\tif (a.className) return false;\n\t\tconst cs = a.childNodes;\n\t\tif (cs.length === 0) return false;\n\t\tfor (const c of cs) {\n\t\t\tif (c.className) return false;\n\t\t\tif (c.nodeType === 1) {  // ELEMENT_NODE\n\t\t\t\tif (c.tagName !== 'BR' && !getComputedStyle(c).display.includes('inline')) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn true;\n\t}\n\t\n\tfunction isEmptyLink(a) {\n\t\treturn !a.className && a.childNodes.length === 0;\n\t}\n\t\n\tfunction isSimpleUrlLink(a, url) {\n\t\treturn url !== null && url !== '' && a.childNodes.length && a.innerHTML.trim() === url;\n\t}\n\t\n\t\n\t// -------------------------------------------------------------------------\n\t\n\t\n\tfunction addClassByUrl(a, url, opts) {\n\t\tconst outIsUp = [false];\n\t\tif (isUrlAnchor(url, a, outIsUp)) {\n\t\t\tsetClass(a, opts.styleLinkAnchor, true, outIsUp[0] ? 'up' : '');\n\t\t} else if (opts.isUrlExternal(url)) {\n\t\t\tsetClass(a, opts.styleLinkExternal);\n\t\t}\n\t\tconst ex = getFileExtension(url);\n\t\tconst tf = opts.fileExtensionTable[ex]  ?? null;\n\t\tconst ti = opts.imageExtensionTable[ex] ?? null;\n\t\tif (tf) {\n\t\t\tsetClass(a, opts.styleLinkFile);\n\t\t\tsetClass(a, opts.styleLinkFile, true, tf);\n\t\t}\n\t\tif (ti) {\n\t\t\tsetClass(a, opts.styleLinkToImage);\n\t\t\tsetClass(a, opts.styleLinkToImage, true, ti);\n\t\t}\n\t}\n\t\n\tfunction isUrlExternal(url) {\n\t\tif (url !== null && url !== '') {\n\t\t\tif (!url.startsWith(`${location.protocol}//${location.host}`)) {\n\t\t\t\tif (url.match(/^https?:\\/\\//) || url.match(/^\\/\\//)) {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\t\n\tfunction getFileExtension(url) {\n\t\tif (url) {\n\t\t\tconst b0 = url.indexOf('//');\n\t\t\tif (b0 !== -1) {\n\t\t\t\tconst b1 = url.indexOf('/', b0 + 2);\n\t\t\t\turl = (b1 !== -1) ? url.substring(b1 + 1) : '';\n\t\t\t}\n\t\t\tconst e0 = url.indexOf('?');\n\t\t\tif (e0 !== -1) url = url.substring(0, e0);\n\t\t\tconst e1 = url.indexOf('#');\n\t\t\tif (e1 !== -1) url = url.substring(0, e1);\n\t\n\t\t\tif (!url.endsWith('/')) {\n\t\t\t\tconst last = url.split('/').pop();\n\t\n\t\t\t\tconst i = last.lastIndexOf('.');\n\t\t\t\tif (i !== -1) {\n\t\t\t\t\treturn last.substring(i + 1).toLowerCase();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t}\n\t\n\tNS.applyType      = apply;\n\tNS.applyTypeByUrl = applyByUrl;\n\n\tNS.isImageLink = isImageLink;\n\n\t/**\n\t *\n\t * Common Functions\n\t *\n\t * @author Takuto Yanagida\n\t * @version 2021-12-27\n\t *\n\t */\n\t\n\t\n\tfunction isUrlAnchor(url, a = null, outIsUp = null) {\n\t\tif (url !== null && url !== '') {\n\t\t\tconst p = url.indexOf('#');\n\t\t\tif (p !== -1) {\n\t\t\t\tconst id = url.substring(p + 1);\n\t\t\t\tif (id.length) {\n\t\t\t\t\tconst t = document.getElementById(id);\n\t\t\t\t\tif (t !== null) {\n\t\t\t\t\t\tif (\n\t\t\t\t\t\t\tp === 0 ||\n\t\t\t\t\t\t\turl.substring(0, p) === location.href.replace(location.hash ? location.hash : '#', '')\n\t\t\t\t\t\t) {\n\t\t\t\t\t\t\tif (a && outIsUp) {\n\t\t\t\t\t\t\t\tconst from = a.getBoundingClientRect().top;\n\t\t\t\t\t\t\t\tconst to   = t.getBoundingClientRect().top;\n\t\t\t\t\t\t\t\tif (to < from) outIsUp[0] = true;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\t\n\tfunction observeAddition(os, fn) {\n\t\tif (!os.length) return;\n\t\tconst mo = new MutationObserver(rs => {\n\t\t\tfor (const r of rs) {\n\t\t\t\tfor (const n of r.addedNodes) {\n\t\t\t\t\tif (n.nodeType === 1 && n.tagName === 'A') {\n\t\t\t\t\t\tfn(n);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\tfor (const o of os) {\n\t\t\tmo.observe(o, {\n\t\t\t\tchildList: true,\n\t\t\t\tsubtree  : true,\n\t\t\t});\n\t\t}\n\t}\n\t\n\n})(window['NACSS']['link']);\n"]}