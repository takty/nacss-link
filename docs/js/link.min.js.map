{"version":3,"sources":["link.js"],"names":["window","NS","setClass","tar","cls","enabled","val","key","substr","startsWith","dataset","c","join","classList","add","remove","apply","as","opts","Object","assign","styleLinkImage","styleLinkSimple","styleLinkAnchor","styleLinkExternal","styleLinkFile","styleLinkToImage","allowedClasses","ALLOWED_CLASSES","fileExtensionTable","FILE_EXT_TABLE","imageExtensionTable","IMG_EXT_TABLE","isUrlExternal","observedSelector","a","addClass","getAttribute","initializeObservation","applyByUrl","addClassByUrl","doc","docx","xls","xlsx","ppt","pptx","pdf","jpeg","jpg","png","gif","observing","sel","includes","push","observeAddition","document","querySelectorAll","o","url","isImageLink","ti","getFileExtension","isEmptyLink","isSimpleLink","isSimpleUrlLink","className","split","ok","childNodes","nodeType","tagName","cs","length","getComputedStyle","display","innerHTML","trim","outIsUp","isUrlAnchor","ex","tf","location","protocol","host","match","b0","indexOf","b1","substring","e0","e1","endsWith","last","pop","i","lastIndexOf","toLowerCase","applyType","applyTypeByUrl","DURATION","isScrolling","anchorWithListener","Set","duration","addListener","addEventListener","has","onClick","e","doClick","href","button","ctrlKey","shiftKey","altKey","metaKey","currentTarget","idx","smoothScrollToHash","hash","documentElement","getElementById","matchMedia","matches","stopPropagation","preventDefault","smoothScrollToElement","history","pushState","focus","start","pageYOffset","timeStart","posY","getScrollPos","wh","offsetHeight","loop","time","scrollTo","easing","requestAnimationFrame","setTimeout","spt","parseInt","scrollPaddingTop","getBoundingClientRect","top","t","b","d","applySmooth","p","id","replace","from","os","fn","mo","MutationObserver","rs","r","n","addedNodes","observe","childList","subtree"],"mappings":"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","file":"link.min.js","sourcesContent":["/**\n *\n * Link\n *\n * @author Takuto Yanagida\n * @version 2021-12-27\n *\n */\n\n\n'use strict';\n\nwindow['NACSS']         = window['NACSS']         || {};\nwindow['NACSS']['link'] = window['NACSS']['link'] || {};\n\n\n((NS) => {\n\n\t/**\n\t *\n\t * Style Class Utilities\n\t *\n\t * @author Takuto Yanagida\n\t * @version 2021-11-11\n\t *\n\t */\n\t\n\t\n\tfunction hasClass(tar, cls) {\n\t\tconst key = cls.substr(1);\n\t\tif (cls.startsWith(':')) {\n\t\t\treturn tar.dataset[key] !== undefined;\n\t\t} else {\n\t\t\treturn tar.classList.contains(key);\n\t\t}\n\t}\n\t\n\tfunction setClass(tar, cls, enabled = true, val = '') {\n\t\tconst key = cls.substr(1);\n\t\tif (cls.startsWith(':')) {\n\t\t\tif (enabled) {\n\t\t\t\ttar.dataset[key] = val;\n\t\t\t} else {\n\t\t\t\tdelete tar.dataset[key];\n\t\t\t}\n\t\t} else {\n\t\t\tconst c = [key, val].join('-');\n\t\t\tif (enabled) {\n\t\t\t\ttar.classList.add(c);\n\t\t\t} else {\n\t\t\t\ttar.classList.remove(c);\n\t\t\t}\n\t\t}\n\t}\n\t\n\tfunction getSelector(cls) {\n\t\tif (cls.startsWith(':')) {\n\t\t\treturn `*[data-${cls.substr(1).replace(/([A-Z])/g, c => '-' + c.charAt(0).toLowerCase())}]`;\n\t\t} else {\n\t\t\treturn `*${cls}`;\n\t\t}\n\t}\n\t\n\t{\n\t\t/**\n\t\t *\n\t\t * Type\n\t\t *\n\t\t * @author Takuto Yanagida\n\t\t * @version 2022-08-05\n\t\t *\n\t\t */\n\t\t\n\t\t\n\t\tfunction apply(as, opts = {}) {\n\t\t\topts = Object.assign({\n\t\t\t\tstyleLinkImage     : ':ncLinkImage',\n\t\t\t\tstyleLinkSimple    : ':ncLinkSimple',\n\t\t\t\tstyleLinkAnchor    : ':ncLinkAnchor',\n\t\t\t\tstyleLinkExternal  : ':ncLinkExternal',\n\t\t\t\tstyleLinkFile      : ':ncLinkFile',\n\t\t\t\tstyleLinkToImage   : ':ncLinkToImage',\n\t\t\t\tallowedClasses     : ALLOWED_CLASSES,\n\t\t\t\tfileExtensionTable : FILE_EXT_TABLE,\n\t\t\t\timageExtensionTable: IMG_EXT_TABLE,\n\t\t\t\tisUrlExternal      : isUrlExternal,\n\t\t\t\tobservedSelector   : null,\n\t\t\t}, opts);\n\t\t\n\t\t\tfor (const a of as) {\n\t\t\t\taddClass(a, a.getAttribute('href'), opts);\n\t\t\t}\n\t\t\tinitializeObservation(opts);\n\t\t}\n\t\t\n\t\tfunction applyByUrl(as, opts = {}) {\n\t\t\topts = Object.assign({\n\t\t\t\tstyleLinkAnchor    : ':ncLinkAnchor',\n\t\t\t\tstyleLinkExternal  : ':ncLinkExternal',\n\t\t\t\tstyleLinkFile      : ':ncLinkFile',\n\t\t\t\tstyleLinkToImage   : ':ncLinkToImage',\n\t\t\t\tfileExtensionTable : FILE_EXT_TABLE,\n\t\t\t\timageExtensionTable: IMG_EXT_TABLE,\n\t\t\t\tisUrlExternal      : isUrlExternal,\n\t\t\t\tobservedSelector   : null,\n\t\t\t}, opts);\n\t\t\n\t\t\tfor (const a of as) {\n\t\t\t\taddClassByUrl(a, a.getAttribute('href'), opts);\n\t\t\t}\n\t\t\tinitializeObservation(opts);\n\t\t}\n\t\t\n\t\tconst ALLOWED_CLASSES = [\n\t\t\t'alignleft',\n\t\t\t'aligncenter',\n\t\t\t'alignright',\n\t\t\t'size-thumbnail',\n\t\t\t'size-small',\n\t\t\t'size-medium-small',\n\t\t\t'size-medium',\n\t\t\t'size-medium-large',\n\t\t\t'size-medium_large',\n\t\t\t'size-large',\n\t\t\t'size-full'\n\t\t];\n\t\t\n\t\tconst FILE_EXT_TABLE = {\n\t\t\tdoc : 'doc',\n\t\t\tdocx: 'doc',\n\t\t\txls : 'xls',\n\t\t\txlsx: 'xls',\n\t\t\tppt : 'ppt',\n\t\t\tpptx: 'ppt',\n\t\t\tpdf : 'pdf',\n\t\t};\n\t\t\n\t\tconst IMG_EXT_TABLE = {\n\t\t\tjpeg: 'jpg',\n\t\t\tjpg : 'jpg',\n\t\t\tpng : 'png',\n\t\t\tgif : 'gif',\n\t\t};\n\t\t\n\t\t\n\t\t// -------------------------------------------------------------------------\n\t\t\n\t\t\n\t\tconst observing = [];\n\t\t\n\t\tfunction initializeObservation(opts) {\n\t\t\tconst sel = opts['observedSelector'];\n\t\t\tif (sel && !observing.includes(sel)) {\n\t\t\t\tobserving.push(sel);\n\t\t\t\tconst os = document.querySelectorAll(sel);\n\t\t\t\tobserveAddition(os, o => addClassByUrl(o, o.getAttribute('href'), opts));\n\t\t\t}\n\t\t}\n\t\t\n\t\tfunction addClass(a, url, opts) {\n\t\t\tif (isImageLink(a, opts)) {\n\t\t\t\tsetClass(a, opts.styleLinkImage);\n\t\t\t\tconst ti = opts.imageExtensionTable[getFileExtension(url)] ?? null;\n\t\t\t\tif (ti) {\n\t\t\t\t\tsetClass(a, opts.styleLinkToImage);\n\t\t\t\t\tsetClass(a, opts.styleLinkToImage, true, ti);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif (isEmptyLink(a)) {\n\t\t\t\t\taddClassByUrl(a, url, opts);\n\t\t\t\t} else if (isSimpleLink(a)) {\n\t\t\t\t\tsetClass(a, opts.styleLinkSimple);\n\t\t\t\t\tif (isSimpleUrlLink(a, url)) {\n\t\t\t\t\t\tsetClass(a, opts.styleLinkSimple, true, 'url');\n\t\t\t\t\t}\n\t\t\t\t\taddClassByUrl(a, url, opts);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\tfunction isImageLink(a, opts) {\n\t\t\tif (a.className) {\n\t\t\t\tfor (const c of a.className.split(' ')) {\n\t\t\t\t\tif (!opts.allowedClasses.includes(c)) return false;\n\t\t\t\t}\n\t\t\t}\n\t\t\tlet ok = false;\n\t\t\tfor (const c of a.childNodes) {\n\t\t\t\tif (c.nodeType === 1) {  // ELEMENT_NODE\n\t\t\t\t\tif (!ok && c.tagName === 'IMG') {\n\t\t\t\t\t\tok = true;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tok = false;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn ok;\n\t\t}\n\t\t\n\t\tfunction isSimpleLink(a) {\n\t\t\tif (a.className) return false;\n\t\t\tconst cs = a.childNodes;\n\t\t\tif (cs.length === 0) return false;\n\t\t\tfor (const c of cs) {\n\t\t\t\tif (c.className) return false;\n\t\t\t\tif (c.nodeType === 1) {  // ELEMENT_NODE\n\t\t\t\t\tif (c.tagName !== 'BR' && !getComputedStyle(c).display.includes('inline')) {\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn true;\n\t\t}\n\t\t\n\t\tfunction isEmptyLink(a) {\n\t\t\treturn !a.className && a.childNodes.length === 0;\n\t\t}\n\t\t\n\t\tfunction isSimpleUrlLink(a, url) {\n\t\t\treturn url !== null && url !== '' && a.childNodes.length && a.innerHTML.trim() === url;\n\t\t}\n\t\t\n\t\t\n\t\t// -------------------------------------------------------------------------\n\t\t\n\t\t\n\t\tfunction addClassByUrl(a, url, opts) {\n\t\t\tconst outIsUp = [false];\n\t\t\tif (isUrlAnchor(url, a, outIsUp)) {\n\t\t\t\tsetClass(a, opts.styleLinkAnchor, true, outIsUp[0] ? 'up' : '');\n\t\t\t} else if (opts.isUrlExternal(url)) {\n\t\t\t\tsetClass(a, opts.styleLinkExternal);\n\t\t\t}\n\t\t\tconst ex = getFileExtension(url);\n\t\t\tconst tf = opts.fileExtensionTable[ex]  ?? null;\n\t\t\tconst ti = opts.imageExtensionTable[ex] ?? null;\n\t\t\tif (tf) {\n\t\t\t\tsetClass(a, opts.styleLinkFile);\n\t\t\t\tsetClass(a, opts.styleLinkFile, true, tf);\n\t\t\t}\n\t\t\tif (ti) {\n\t\t\t\tsetClass(a, opts.styleLinkToImage);\n\t\t\t\tsetClass(a, opts.styleLinkToImage, true, ti);\n\t\t\t}\n\t\t}\n\t\t\n\t\tfunction isUrlExternal(url) {\n\t\t\tif (url !== null && url !== '') {\n\t\t\t\tif (!url.startsWith(`${location.protocol}//${location.host}`)) {\n\t\t\t\t\tif (url.match(/^https?:\\/\\//) || url.match(/^\\/\\//)) {\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn false;\n\t\t}\n\t\t\n\t\tfunction getFileExtension(url) {\n\t\t\tif (url) {\n\t\t\t\tconst b0 = url.indexOf('//');\n\t\t\t\tif (b0 !== -1) {\n\t\t\t\t\tconst b1 = url.indexOf('/', b0 + 2);\n\t\t\t\t\turl = (b1 !== -1) ? url.substring(b1 + 1) : '';\n\t\t\t\t}\n\t\t\t\tconst e0 = url.indexOf('?');\n\t\t\t\tif (e0 !== -1) url = url.substring(0, e0);\n\t\t\t\tconst e1 = url.indexOf('#');\n\t\t\t\tif (e1 !== -1) url = url.substring(0, e1);\n\t\t\n\t\t\t\tif (!url.endsWith('/')) {\n\t\t\t\t\tconst last = url.split('/').pop();\n\t\t\n\t\t\t\t\tconst i = last.lastIndexOf('.');\n\t\t\t\t\tif (i !== -1) {\n\t\t\t\t\t\treturn last.substring(i + 1).toLowerCase();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn null;\n\t\t}\n\t\t\n\t\tNS.applyType      = apply;\n\t\tNS.applyTypeByUrl = applyByUrl;\n\n\t\tNS.isImageLink = isImageLink;\n\t}\n\t{\n\t\t/**\n\t\t *\n\t\t * Smooth Scroll\n\t\t *\n\t\t * @author Takuto Yanagida\n\t\t * @version 2021-12-26\n\t\t *\n\t\t */\n\t\t\n\t\t\n\t\tconst DURATION = 400;\n\t\t\n\t\tlet isScrolling = false;\n\t\tconst anchorWithListener = new Set();\n\t\t\n\t\tfunction apply(as, opts = {}) {\n\t\t\topts = Object.assign({\n\t\t\t\tduration        : DURATION,\n\t\t\t\tobservedSelector: null,\n\t\t\t}, opts);\n\t\t\n\t\t\tfor (const a of as) {\n\t\t\t\taddListener(a, opts);\n\t\t\t}\n\t\t\tdocument.addEventListener('wheel', () => { isScrolling = false; });\n\t\t\n\t\t\tif (opts['observedSelector']) {\n\t\t\t\tconst os = document.querySelectorAll(opts['observedSelector']);\n\t\t\t\tobserveAddition(os, o => addListener(o, opts));\n\t\t\t}\n\t\t}\n\t\t\n\t\t\n\t\t// -----------------------------------------------------------------------------\n\t\t\n\t\t\n\t\tfunction addListener(a, opts) {\n\t\t\tif (!anchorWithListener.has(a)) {\n\t\t\t\tfunction onClick(e) { doClick(e, opts); }\n\t\t\t\tif (a.href === '#' || a.href === '#top' || isUrlAnchor(a.href)) {\n\t\t\t\t\ta.addEventListener('click', onClick);\n\t\t\t\t\tanchorWithListener.add(a);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\tfunction doClick(e, opts) {\n\t\t\tif (e.button !== 0 || e.ctrlKey || e.shiftKey || e.altKey || e.metaKey) return;\n\t\t\tconst href = e.currentTarget.getAttribute('href');\n\t\t\tconst idx  = href.indexOf('#');\n\t\t\tif (idx !== -1) {\n\t\t\t\tsmoothScrollToHash(e, href.substring(idx), opts.duration);\n\t\t\t}\n\t\t}\n\t\t\n\t\tfunction smoothScrollToHash(e, hash, duration = DURATION) {\n\t\t\tconst top = (hash === null || hash === '' || hash === '#' || hash === '#top');\n\t\t\tconst tar = top ? document.documentElement : document.getElementById(hash.substring(1));\n\t\t\tif (tar && !window.matchMedia('(prefers-reduced-motion: reduce)').matches) {\n\t\t\t\te.stopPropagation();\n\t\t\t\te.preventDefault();\n\t\t\n\t\t\t\tsmoothScrollToElement(tar, duration);\n\t\t\t\tif (hash !== window.location.hash) {\n\t\t\t\t\thistory.pushState(null, null, (hash === '#top' ? '' : hash));\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\t\n\t\t// -----------------------------------------------------------------------------\n\t\t\n\t\t\n\t\tfunction smoothScrollToElement(tar, duration = DURATION, focus = true) {\n\t\t\tconst start = window.pageYOffset;\n\t\t\tlet posY = getScrollPos(tar);\n\t\t\tlet wh   = document.documentElement.offsetHeight;\n\t\t\n\t\t\tlet timeStart;\n\t\t\tisScrolling = true;\n\t\t\trequestAnimationFrame((time) => { timeStart = time; loop(time); });\n\t\t\n\t\t\tfunction loop(time) {\n\t\t\t\tif (!isScrolling) return;\n\t\t\t\tif (wh !== document.documentElement.offsetHeight) {  // For delay loading\n\t\t\t\t\tposY = getScrollPos(tar);\n\t\t\t\t\twh   = document.documentElement.offsetHeight;\n\t\t\t\t}\n\t\t\t\twindow.scrollTo(0, easing(time - timeStart, start, posY, duration));\n\t\t\t\tif (time - timeStart < duration) {\n\t\t\t\t\trequestAnimationFrame(loop)\n\t\t\t\t} else {\n\t\t\t\t\twindow.scrollTo(0, getScrollPos(tar));\n\t\t\t\t\tsetTimeout(() => window.scrollTo(0, getScrollPos(tar)), 50);\n\t\t\t\t\tif (focus && tar && tar !== document.documentElement) {\n\t\t\t\t\t\ttar.focus();\n\t\t\t\t\t}\n\t\t\t\t\tisScrolling = false;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\tfunction getScrollPos(tar) {\n\t\t\tconst spt = parseInt(getComputedStyle(document.documentElement).scrollPaddingTop);\n\t\t\treturn tar.getBoundingClientRect().top + window.pageYOffset - spt;\n\t\t}\n\t\t\n\t\tfunction easing(t, b, c, d) {\n\t\t\tt /= d / 2;\n\t\t\tif (t < 1) return (c - b) / 2 * t * t + b;\n\t\t\tt--;\n\t\t\treturn -(c - b) / 2 * (t * (t - 2) - 1) + b;\n\t\t}\n\t\t\n\t\tNS.applySmooth = apply;\n\n\t\tNS.smoothScrollToElement = smoothScrollToElement;\n\t}\n\t/**\n\t *\n\t * Common Functions\n\t *\n\t * @author Takuto Yanagida\n\t * @version 2021-12-27\n\t *\n\t */\n\t\n\t\n\tfunction isUrlAnchor(url, a = null, outIsUp = null) {\n\t\tif (url !== null && url !== '') {\n\t\t\tconst p = url.indexOf('#');\n\t\t\tif (p !== -1) {\n\t\t\t\tconst id = url.substring(p + 1);\n\t\t\t\tif (id.length) {\n\t\t\t\t\tconst t = document.getElementById(id);\n\t\t\t\t\tif (t !== null) {\n\t\t\t\t\t\tif (\n\t\t\t\t\t\t\tp === 0 ||\n\t\t\t\t\t\t\turl.substring(0, p) === location.href.replace(location.hash ? location.hash : '#', '')\n\t\t\t\t\t\t) {\n\t\t\t\t\t\t\tif (a && outIsUp) {\n\t\t\t\t\t\t\t\tconst from = a.getBoundingClientRect().top;\n\t\t\t\t\t\t\t\tconst to   = t.getBoundingClientRect().top;\n\t\t\t\t\t\t\t\tif (to < from) outIsUp[0] = true;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\t\n\tfunction observeAddition(os, fn) {\n\t\tif (!os.length) return;\n\t\tconst mo = new MutationObserver(rs => {\n\t\t\tfor (const r of rs) {\n\t\t\t\tfor (const n of r.addedNodes) {\n\t\t\t\t\tif (n.nodeType === 1 && n.tagName === 'A') {\n\t\t\t\t\t\tfn(n);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\tfor (const o of os) {\n\t\t\tmo.observe(o, {\n\t\t\t\tchildList: true,\n\t\t\t\tsubtree  : true,\n\t\t\t});\n\t\t}\n\t}\n\t\n\n})(window['NACSS']['link']);\n"]}