{"version":3,"sources":["link-anchor.js"],"names":["window","NS","isScrolling","anchorWithListener","Set","apply","a","opts","has","href","url","outIsUp","p","indexOf","id","substring","length","t","document","getElementById","location","replace","hash","from","getBoundingClientRect","top","isUrlAnchor","addEventListener","e","button","ctrlKey","shiftKey","altKey","metaKey","currentTarget","getAttribute","idx","duration","DURATION","tar","documentElement","matchMedia","matches","stopPropagation","preventDefault","smoothScrollToElement","history","pushState","smoothScrollToHash","doClick","add","focus","start","pageYOffset","timeStart","posY","getScrollPos","wh","offsetHeight","loop","time","b","c","scrollTo","requestAnimationFrame","setTimeout","spt","parseInt","getComputedStyle","scrollPaddingTop","linkAnchorScroll","as","Object","assign","observedSelector","oes","querySelectorAll","mo","MutationObserver","rs","r","n","addedNodes","nodeType","tagName","oe","observe","childList","subtree"],"mappings":"AAUAA,OAAM,MAAYA,OAAM,OAAa,GAGrC,SAAWC,IAEV,WAaC,IAAIC,GAAc,EAClB,MAAMC,EAAqB,IAAIC,IAmC/B,SAASC,EAAMC,EAAGC,GACjB,IAAKJ,EAAmBK,IAAIF,GAAI,EAEhB,MAAXA,EAAEG,MAA2B,SAAXH,EAAEG,MAwI3B,SAAqBC,EAAKJ,EAAI,KAAMK,EAAU,MAC7C,GAAY,OAARD,GAAwB,KAARA,EAAY,CAC/B,MAAME,EAAIF,EAAIG,QAAQ,KACtB,IAAW,IAAPD,EAAU,CACb,MAAME,EAAKJ,EAAIK,UAAUH,EAAI,GAC7B,GAAIE,EAAGE,OAAQ,CACd,MAAMC,EAAIC,SAASC,eAAeL,GAClC,GAAU,OAANG,IAEI,IAANL,GACAF,EAAIK,UAAU,EAAGH,KAAOQ,SAASX,KAAKY,QAAQD,SAASE,KAAOF,SAASE,KAAO,IAAK,KAClF,CACD,GAAIhB,GAAKK,EAAS,CACjB,MAAMY,EAAOjB,EAAEkB,wBAAwBC,IAC1BR,EAAEO,wBAAwBC,IAC9BF,IAAMZ,EAAQ,IAAK,GAE7B,OAAO,KAMZ,OAAO,EA/JsCe,CAAYpB,EAAEG,SACxDH,EAAEqB,iBAAiB,SAFpB,SAAiBC,IAQnB,SAAiBA,EAAGrB,GACnB,GAAiB,IAAbqB,EAAEC,QAAgBD,EAAEE,SAAWF,EAAEG,UAAYH,EAAEI,QAAUJ,EAAEK,QAAS,OACxE,MAAMxB,EAAOmB,EAAEM,cAAcC,aAAa,QACpCC,EAAO3B,EAAKI,QAAQ,MACb,IAATuB,GAKL,SAA4BR,EAAGN,EAAMe,EAAWC,KAC/C,MACMC,EADgB,OAATjB,GAA0B,KAATA,GAAwB,MAATA,GAAyB,SAATA,EAC3CJ,SAASsB,gBAAkBtB,SAASC,eAAeG,EAAKP,UAAU,IAChFwB,IAAQvC,OAAOyC,WAAW,oCAAoCC,UACjEd,EAAEe,kBACFf,EAAEgB,iBAEFC,EAAsBN,EAAKF,GACvBf,IAAStB,OAAOoB,SAASE,MAC5BwB,QAAQC,UAAU,KAAM,KAAgB,SAATzB,EAAkB,GAAKA,IAbvD0B,CAAmBpB,EAAGnB,EAAKM,UAAUqB,GAAM7B,EAAK8B,UAb1BY,CAAQrB,EAAGrB,MAGhCJ,EAAmB+C,IAAI5C,KAgC1B,SAASuC,EAAsBN,EAAKF,EAAWC,IAAUa,GAAQ,GAChE,MAAMC,EAAQpD,OAAOqD,YACrB,IAGIC,EAHAC,EAAOC,EAAajB,GACpBkB,EAAOvC,SAASsB,gBAAgBkB,aAMpC,SAASC,EAAKC,GAyBf,IAAgB3C,EAAG4C,EAAGC,EAxBf5D,IACDuD,IAAOvC,SAASsB,gBAAgBkB,eACnCH,EAAOC,EAAajB,GACpBkB,EAAOvC,SAASsB,gBAAgBkB,cAEjC1D,OAAO+D,SAAS,GAmBF9C,EAnBY2C,EAAON,EAmBhBO,EAnB2BT,EAmBxBU,EAnB+BP,GAoBpDtC,GApB0DoB,EAoBjD,GACD,GAAWyB,EAAID,GAAK,EAAI5C,EAAIA,EAAI4C,GACxC5C,MACS6C,EAAID,GAAK,GAAK5C,GAAKA,EAAI,GAAK,GAAK4C,KAtBrCD,EAAON,EAAYjB,EACtB2B,sBAAsBL,IAEtB3D,OAAO+D,SAAS,EAAGP,EAAajB,IAChC0B,YAAW,IAAMjE,OAAO+D,SAAS,EAAGP,EAAajB,KAAO,IACpDY,GAASZ,GAAOA,IAAQrB,SAASsB,iBACpCD,EAAIY,QAELjD,GAAc,IAlBhBA,GAAc,EACd8D,uBAAuBJ,IAAWN,EAAYM,EAAMD,EAAKC,MAsB1D,SAASJ,EAAajB,GACrB,MAAM2B,EAAMC,SAASC,iBAAiBlD,SAASsB,iBAAiB6B,kBAChE,OAAO9B,EAAIf,wBAAwBC,IAAMzB,OAAOqD,YAAca,EAU/DjE,EAAGqE,iBA/GH,SAAoBC,EAAIhE,EAAO,IAC9BA,EAAOiE,OAAOC,OAAO,CACpBpC,SAPe,IAQfqC,iBAAkB,MAChBnE,GAEH,IAAK,MAAMD,KAAKiE,EACflE,EAAMC,EAAGC,GAIV,GAFAW,SAASS,iBAAiB,SAAS,KAAQzB,GAAc,KAErDK,EAAI,iBAAsB,CAC7B,MAAMoE,EAAMzD,SAAS0D,iBAAiBrE,EAAI,kBAC1C,GAAIoE,EAAI3D,OAAQ,CACf,MAAM6D,EAAK,IAAIC,kBAAiBC,IAC/B,IAAK,MAAMC,KAAKD,EACf,IAAK,MAAME,KAAKD,EAAEE,WACE,IAAfD,EAAEE,UAAgC,MAAdF,EAAEG,SACzB/E,EAAM4E,EAAG1E,MAKb,IAAK,MAAM8E,KAAMV,EAChBE,EAAGS,QAAQD,EAAI,CACdE,WAAW,EACXC,SAAW,OAwFhBvF,EAAG4C,sBAAwBA,EAlI5B,GAFD,CAyNG7C,OAAM","file":"link-anchor.min.js","sourcesContent":["/**\n *\n * Link - Anchor Scroll\n *\n * @author Takuto Yanagida\n * @version 2021-11-11\n *\n */\n\n\nwindow['NACSS'] = window['NACSS'] || {};\n\n\n(function (NS) {\n\n\t(function () {\n\t\t/**\n\t\t *\n\t\t * Anchor Scroll\n\t\t *\n\t\t * @author Takuto Yanagida\n\t\t * @version 2021-11-29\n\t\t *\n\t\t */\n\t\t\n\t\t\n\t\tconst DURATION = 400;\n\t\t\n\t\tlet isScrolling = false;\n\t\tconst anchorWithListener = new Set();\n\t\t\n\t\tfunction initialize(as, opts = {}) {\n\t\t\topts = Object.assign({\n\t\t\t\tduration        : DURATION,\n\t\t\t\tobservedSelector: null,\n\t\t\t}, opts);\n\t\t\n\t\t\tfor (const a of as) {\n\t\t\t\tapply(a, opts);\n\t\t\t}\n\t\t\tdocument.addEventListener('wheel', () => { isScrolling = false; });\n\t\t\n\t\t\tif (opts['observedSelector']) {\n\t\t\t\tconst oes = document.querySelectorAll(opts['observedSelector']);\n\t\t\t\tif (oes.length) {\n\t\t\t\t\tconst mo = new MutationObserver(rs => {\n\t\t\t\t\t\tfor (const r of rs) {\n\t\t\t\t\t\t\tfor (const n of r.addedNodes) {\n\t\t\t\t\t\t\t\tif (n.nodeType === 1 && n.tagName === 'A') {\n\t\t\t\t\t\t\t\t\tapply(n, opts);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\tfor (const oe of oes) {\n\t\t\t\t\t\tmo.observe(oe, {\n\t\t\t\t\t\t\tchildList: true,\n\t\t\t\t\t\t\tsubtree  : true,\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\tfunction apply(a, opts) {\n\t\t\tif (!anchorWithListener.has(a)) {\n\t\t\t\tfunction onClick(e) { doClick(e, opts); }\n\t\t\t\tif (a.href === '#' || a.href === '#top' || isUrlAnchor(a.href)) {\n\t\t\t\t\ta.addEventListener('click', onClick);\n\t\t\t\t\tanchorWithListener.add(a);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\tfunction doClick(e, opts) {\n\t\t\tif (e.button !== 0 || e.ctrlKey || e.shiftKey || e.altKey || e.metaKey) return;\n\t\t\tconst href = e.currentTarget.getAttribute('href');\n\t\t\tconst idx  = href.indexOf('#');\n\t\t\tif (idx !== -1) {\n\t\t\t\tsmoothScrollToHash(e, href.substring(idx), opts.duration);\n\t\t\t}\n\t\t}\n\t\t\n\t\tfunction smoothScrollToHash(e, hash, duration = DURATION) {\n\t\t\tconst top = (hash === null || hash === '' || hash === '#' || hash === '#top');\n\t\t\tconst tar = top ? document.documentElement : document.getElementById(hash.substring(1));\n\t\t\tif (tar && !window.matchMedia('(prefers-reduced-motion: reduce)').matches) {\n\t\t\t\te.stopPropagation();\n\t\t\t\te.preventDefault();\n\t\t\n\t\t\t\tsmoothScrollToElement(tar, duration);\n\t\t\t\tif (hash !== window.location.hash) {\n\t\t\t\t\thistory.pushState(null, null, (hash === '#top' ? '' : hash));\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\t\n\t\t// -----------------------------------------------------------------------------\n\t\t\n\t\t\n\t\tfunction smoothScrollToElement(tar, duration = DURATION, focus = true) {\n\t\t\tconst start = window.pageYOffset;\n\t\t\tlet posY = getScrollPos(tar);\n\t\t\tlet wh   = document.documentElement.offsetHeight;\n\t\t\n\t\t\tlet timeStart;\n\t\t\tisScrolling = true;\n\t\t\trequestAnimationFrame((time) => { timeStart = time; loop(time); });\n\t\t\n\t\t\tfunction loop(time) {\n\t\t\t\tif (!isScrolling) return;\n\t\t\t\tif (wh !== document.documentElement.offsetHeight) {  // For delay loading\n\t\t\t\t\tposY = getScrollPos(tar);\n\t\t\t\t\twh   = document.documentElement.offsetHeight;\n\t\t\t\t}\n\t\t\t\twindow.scrollTo(0, easing(time - timeStart, start, posY, duration));\n\t\t\t\tif (time - timeStart < duration) {\n\t\t\t\t\trequestAnimationFrame(loop)\n\t\t\t\t} else {\n\t\t\t\t\twindow.scrollTo(0, getScrollPos(tar));\n\t\t\t\t\tsetTimeout(() => window.scrollTo(0, getScrollPos(tar)), 50);\n\t\t\t\t\tif (focus && tar && tar !== document.documentElement) {\n\t\t\t\t\t\ttar.focus();\n\t\t\t\t\t}\n\t\t\t\t\tisScrolling = false;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\tfunction getScrollPos(tar) {\n\t\t\tconst spt = parseInt(getComputedStyle(document.documentElement).scrollPaddingTop);\n\t\t\treturn tar.getBoundingClientRect().top + window.pageYOffset - spt;\n\t\t}\n\t\t\n\t\tfunction easing(t, b, c, d) {\n\t\t\tt /= d / 2;\n\t\t\tif (t < 1) return (c - b) / 2 * t * t + b;\n\t\t\tt--;\n\t\t\treturn -(c - b) / 2 * (t * (t - 2) - 1) + b;\n\t\t}\n\t\t\n\t\tNS.linkAnchorScroll = initialize;\n\n\t\t// Export the function\n\t\tNS.smoothScrollToElement = smoothScrollToElement;\n\t})();\n\n\t/**\n\t *\n\t * Style Class Utilities\n\t *\n\t * @author Takuto Yanagida\n\t * @version 2021-11-11\n\t *\n\t */\n\t\n\t\n\tfunction hasClass(tar, cls) {\n\t\tconst key = cls.substr(1);\n\t\tif (cls.startsWith(':')) {\n\t\t\treturn tar.dataset[key] !== undefined;\n\t\t} else {\n\t\t\treturn tar.classList.contains(key);\n\t\t}\n\t}\n\t\n\tfunction setClass(tar, cls, enabled = true, val = '') {\n\t\tconst key = cls.substr(1);\n\t\tif (cls.startsWith(':')) {\n\t\t\tif (enabled) {\n\t\t\t\ttar.dataset[key] = val;\n\t\t\t} else {\n\t\t\t\tdelete tar.dataset[key];\n\t\t\t}\n\t\t} else {\n\t\t\tconst c = [key, val].join('-');\n\t\t\tif (enabled) {\n\t\t\t\ttar.classList.add(c);\n\t\t\t} else {\n\t\t\t\ttar.classList.remove(c);\n\t\t\t}\n\t\t}\n\t}\n\t\n\tfunction getSelector(cls) {\n\t\tif (cls.startsWith(':')) {\n\t\t\treturn `*[data-${cls.substr(1).replace(/([A-Z])/g, c => '-' + c.charAt(0).toLowerCase())}]`;\n\t\t} else {\n\t\t\treturn `*${cls}`;\n\t\t}\n\t}\n\t\n\t/**\n\t *\n\t * Common Functions\n\t *\n\t * @author Takuto Yanagida\n\t * @version 2021-11-10\n\t *\n\t */\n\t\n\t\n\tfunction isUrlAnchor(url, a = null, outIsUp = null) {\n\t\tif (url !== null && url !== '') {\n\t\t\tconst p = url.indexOf('#');\n\t\t\tif (p !== -1) {\n\t\t\t\tconst id = url.substring(p + 1);\n\t\t\t\tif (id.length) {\n\t\t\t\t\tconst t = document.getElementById(id);\n\t\t\t\t\tif (t !== null) {\n\t\t\t\t\t\tif (\n\t\t\t\t\t\t\tp === 0 ||\n\t\t\t\t\t\t\turl.substring(0, p) === location.href.replace(location.hash ? location.hash : '#', '')\n\t\t\t\t\t\t) {\n\t\t\t\t\t\t\tif (a && outIsUp) {\n\t\t\t\t\t\t\t\tconst from = a.getBoundingClientRect().top;\n\t\t\t\t\t\t\t\tconst to   = t.getBoundingClientRect().top;\n\t\t\t\t\t\t\t\tif (to < from) outIsUp[0] = true;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\t\n\n})(window['NACSS']);\n"]}