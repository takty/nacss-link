{"version":3,"sources":["link-anchor.js"],"names":["window","NS","DURATION","isScrolling","anchorWithListener","Set","initialize","as","opts","Object","assign","duration","observedSelector","a","apply","document","addEventListener","oes","querySelectorAll","length","mo","MutationObserver","rs","r","n","addedNodes","nodeType","tagName","oe","observe","childList","subtree","has","onClick","e","doClick","href","url","outIsUp","p","indexOf","id","substring","t","getElementById","location","replace","hash","from","getBoundingClientRect","top","isUrlAnchor","add","button","ctrlKey","shiftKey","altKey","metaKey","currentTarget","getAttribute","idx","smoothScrollToHash","tar","documentElement","matchMedia","matches","stopPropagation","preventDefault","smoothScrollToElement","history","pushState","focus","start","pageYOffset","timeStart","posY","getScrollPos","wh","offsetHeight","loop","time","scrollTo","easing","requestAnimationFrame","setTimeout","spt","parseInt","getComputedStyle","scrollPaddingTop","b","c","d","linkAnchorScroll"],"mappings":"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","file":"link-anchor.min.js","sourcesContent":["/**\n *\n * Link - Anchor Scroll\n *\n * @author Takuto Yanagida\n * @version 2021-12-06\n *\n */\n\n\n'use strict';\n\nwindow['NACSS'] = window['NACSS'] || {};\n\n\n(function (NS) {\n\n\t{\n\t\t/**\n\t\t *\n\t\t * Anchor Scroll\n\t\t *\n\t\t * @author Takuto Yanagida\n\t\t * @version 2021-11-29\n\t\t *\n\t\t */\n\t\t\n\t\t\n\t\tconst DURATION = 400;\n\t\t\n\t\tlet isScrolling = false;\n\t\tconst anchorWithListener = new Set();\n\t\t\n\t\tfunction initialize(as, opts = {}) {\n\t\t\topts = Object.assign({\n\t\t\t\tduration        : DURATION,\n\t\t\t\tobservedSelector: null,\n\t\t\t}, opts);\n\t\t\n\t\t\tfor (const a of as) {\n\t\t\t\tapply(a, opts);\n\t\t\t}\n\t\t\tdocument.addEventListener('wheel', () => { isScrolling = false; });\n\t\t\n\t\t\tif (opts['observedSelector']) {\n\t\t\t\tconst oes = document.querySelectorAll(opts['observedSelector']);\n\t\t\t\tif (oes.length) {\n\t\t\t\t\tconst mo = new MutationObserver(rs => {\n\t\t\t\t\t\tfor (const r of rs) {\n\t\t\t\t\t\t\tfor (const n of r.addedNodes) {\n\t\t\t\t\t\t\t\tif (n.nodeType === 1 && n.tagName === 'A') {\n\t\t\t\t\t\t\t\t\tapply(n, opts);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\tfor (const oe of oes) {\n\t\t\t\t\t\tmo.observe(oe, {\n\t\t\t\t\t\t\tchildList: true,\n\t\t\t\t\t\t\tsubtree  : true,\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\tfunction apply(a, opts) {\n\t\t\tif (!anchorWithListener.has(a)) {\n\t\t\t\tfunction onClick(e) { doClick(e, opts); }\n\t\t\t\tif (a.href === '#' || a.href === '#top' || isUrlAnchor(a.href)) {\n\t\t\t\t\ta.addEventListener('click', onClick);\n\t\t\t\t\tanchorWithListener.add(a);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\tfunction doClick(e, opts) {\n\t\t\tif (e.button !== 0 || e.ctrlKey || e.shiftKey || e.altKey || e.metaKey) return;\n\t\t\tconst href = e.currentTarget.getAttribute('href');\n\t\t\tconst idx  = href.indexOf('#');\n\t\t\tif (idx !== -1) {\n\t\t\t\tsmoothScrollToHash(e, href.substring(idx), opts.duration);\n\t\t\t}\n\t\t}\n\t\t\n\t\tfunction smoothScrollToHash(e, hash, duration = DURATION) {\n\t\t\tconst top = (hash === null || hash === '' || hash === '#' || hash === '#top');\n\t\t\tconst tar = top ? document.documentElement : document.getElementById(hash.substring(1));\n\t\t\tif (tar && !window.matchMedia('(prefers-reduced-motion: reduce)').matches) {\n\t\t\t\te.stopPropagation();\n\t\t\t\te.preventDefault();\n\t\t\n\t\t\t\tsmoothScrollToElement(tar, duration);\n\t\t\t\tif (hash !== window.location.hash) {\n\t\t\t\t\thistory.pushState(null, null, (hash === '#top' ? '' : hash));\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\t\n\t\t// -----------------------------------------------------------------------------\n\t\t\n\t\t\n\t\tfunction smoothScrollToElement(tar, duration = DURATION, focus = true) {\n\t\t\tconst start = window.pageYOffset;\n\t\t\tlet posY = getScrollPos(tar);\n\t\t\tlet wh   = document.documentElement.offsetHeight;\n\t\t\n\t\t\tlet timeStart;\n\t\t\tisScrolling = true;\n\t\t\trequestAnimationFrame((time) => { timeStart = time; loop(time); });\n\t\t\n\t\t\tfunction loop(time) {\n\t\t\t\tif (!isScrolling) return;\n\t\t\t\tif (wh !== document.documentElement.offsetHeight) {  // For delay loading\n\t\t\t\t\tposY = getScrollPos(tar);\n\t\t\t\t\twh   = document.documentElement.offsetHeight;\n\t\t\t\t}\n\t\t\t\twindow.scrollTo(0, easing(time - timeStart, start, posY, duration));\n\t\t\t\tif (time - timeStart < duration) {\n\t\t\t\t\trequestAnimationFrame(loop)\n\t\t\t\t} else {\n\t\t\t\t\twindow.scrollTo(0, getScrollPos(tar));\n\t\t\t\t\tsetTimeout(() => window.scrollTo(0, getScrollPos(tar)), 50);\n\t\t\t\t\tif (focus && tar && tar !== document.documentElement) {\n\t\t\t\t\t\ttar.focus();\n\t\t\t\t\t}\n\t\t\t\t\tisScrolling = false;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\tfunction getScrollPos(tar) {\n\t\t\tconst spt = parseInt(getComputedStyle(document.documentElement).scrollPaddingTop);\n\t\t\treturn tar.getBoundingClientRect().top + window.pageYOffset - spt;\n\t\t}\n\t\t\n\t\tfunction easing(t, b, c, d) {\n\t\t\tt /= d / 2;\n\t\t\tif (t < 1) return (c - b) / 2 * t * t + b;\n\t\t\tt--;\n\t\t\treturn -(c - b) / 2 * (t * (t - 2) - 1) + b;\n\t\t}\n\t\t\n\t\tNS.linkAnchorScroll = initialize;\n\n\t\t// Export the function\n\t\tNS.smoothScrollToElement = smoothScrollToElement;\n\t}\n\n\t/**\n\t *\n\t * Style Class Utilities\n\t *\n\t * @author Takuto Yanagida\n\t * @version 2021-11-11\n\t *\n\t */\n\t\n\t\n\tfunction hasClass(tar, cls) {\n\t\tconst key = cls.substr(1);\n\t\tif (cls.startsWith(':')) {\n\t\t\treturn tar.dataset[key] !== undefined;\n\t\t} else {\n\t\t\treturn tar.classList.contains(key);\n\t\t}\n\t}\n\t\n\tfunction setClass(tar, cls, enabled = true, val = '') {\n\t\tconst key = cls.substr(1);\n\t\tif (cls.startsWith(':')) {\n\t\t\tif (enabled) {\n\t\t\t\ttar.dataset[key] = val;\n\t\t\t} else {\n\t\t\t\tdelete tar.dataset[key];\n\t\t\t}\n\t\t} else {\n\t\t\tconst c = [key, val].join('-');\n\t\t\tif (enabled) {\n\t\t\t\ttar.classList.add(c);\n\t\t\t} else {\n\t\t\t\ttar.classList.remove(c);\n\t\t\t}\n\t\t}\n\t}\n\t\n\tfunction getSelector(cls) {\n\t\tif (cls.startsWith(':')) {\n\t\t\treturn `*[data-${cls.substr(1).replace(/([A-Z])/g, c => '-' + c.charAt(0).toLowerCase())}]`;\n\t\t} else {\n\t\t\treturn `*${cls}`;\n\t\t}\n\t}\n\t\n\t/**\n\t *\n\t * Common Functions\n\t *\n\t * @author Takuto Yanagida\n\t * @version 2021-11-10\n\t *\n\t */\n\t\n\t\n\tfunction isUrlAnchor(url, a = null, outIsUp = null) {\n\t\tif (url !== null && url !== '') {\n\t\t\tconst p = url.indexOf('#');\n\t\t\tif (p !== -1) {\n\t\t\t\tconst id = url.substring(p + 1);\n\t\t\t\tif (id.length) {\n\t\t\t\t\tconst t = document.getElementById(id);\n\t\t\t\t\tif (t !== null) {\n\t\t\t\t\t\tif (\n\t\t\t\t\t\t\tp === 0 ||\n\t\t\t\t\t\t\turl.substring(0, p) === location.href.replace(location.hash ? location.hash : '#', '')\n\t\t\t\t\t\t) {\n\t\t\t\t\t\t\tif (a && outIsUp) {\n\t\t\t\t\t\t\t\tconst from = a.getBoundingClientRect().top;\n\t\t\t\t\t\t\t\tconst to   = t.getBoundingClientRect().top;\n\t\t\t\t\t\t\t\tif (to < from) outIsUp[0] = true;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\t\n\n})(window['NACSS']);\n"]}